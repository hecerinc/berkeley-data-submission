javascript: (function () {var menso=document.createElement("script");document.body.appendChild(menso),menso.onload=function(){function e(e){return t(moment(e,"D [de] MMM YYYY H:mm","es",!0).format())}function t(e){var t=e.lastIndexOf("-"),n=e.substring(0,t);return n.replace(/-/g,"").replace(/:/g,"")}function n(e){for(var t=e.nextElementSibling,n=[];t&&"#9bbad6"!==t.getAttribute("bgcolor");){if("#EEEEEE"===t.getAttribute("bgcolor")){var o,r=t.children[1].textContent.trim(),a=t.children[2].textContent,s=t.children[3].textContent.trim(),i=t.children[4].textContent.trim(),m=t.children[5].textContent.trim();"A-"==i.substr(0,2)&&(i=i.substr(2)),o=i==m?m:i+m,n.push({fechas:r,salon:o,horario:s,dias:a})}t=t.nextElementSibling}return n}function o(){var e="text/calendar",t=new Blob([i],{type:e});window.location.href=window.URL.createObjectURL(t)}var r="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),a="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");moment.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(e,t){return e?/-MMM-/.test(t)?a[e.month()]:r[e.month()]:r},monthsParseExact:!0,weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},dayOfMonthOrdinalParse:/\d{1,2}º/,ordinal:"%dº",week:{dow:1,doy:4}}),moment.locale("es"),moment.updateLocale("es",{monthsShort:moment.monthsShort("-MMM-")}),String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return void 0!==e[n]?e[n]:t})});for(var s=["SU","MO","TU","WE","TH","FR","SA"],i="BEGIN:VCALENDAR\nPRODID:-//Microsoft Corporation//Outlook 16.0 MIMEDIR//EN\nVERSION:2.0\nMETHOD:PUBLISH\nBEGIN:VTIMEZONE\nTZID:Central Standard Time\nBEGIN:STANDARD\nDTSTART:16011104T020000\nRRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11\nTZOFFSETFROM:-0500\nTZOFFSETTO:-0600\nEND:STANDARD\nBEGIN:DAYLIGHT\nDTSTART:16010311T020000\nRRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3\nTZOFFSETFROM:-0600\nTZOFFSETTO:-0500\nEND:DAYLIGHT\nEND:VTIMEZONE\n",m='BEGIN:VEVENT\nCLASS:PUBLIC\nCREATED:{0}\nUID:{0}-123401@itesm.mx\nDESCRIPTION: \\n\nDTSTART;TZID="Central Standard Time":{1}\nDTEND;TZID="Central Standard Time":{2}\nDTSTAMP:{0}\nLOCATION:{3}\nRRULE:FREQ=WEEKLY;UNTIL={4};BYDAY={5}\nSEQUENCE:0\nSUMMARY;LANGUAGE=en-us:{6}\nTRANSP:OPAQUE\nEND:VEVENT\n',d=document.getElementById("Item.MessageNormalizedBody"),l=d.querySelectorAll("center")[2],u=l.querySelectorAll("table")[1],c=u.children[0],E=(c.children,c.querySelectorAll('tr[bgcolor="#9bbad6"]')),T=[],_=0;_<E.length;_++)T.push({name:E[_].children[1].querySelector("code").textContent.trim(),details:n(E[_])});T.forEach(function(t){var n=(new Date).toISOString().replace(/-/g,"");n=n.substring(0,n.indexOf(".")).replace(/:/g,"")+"Z",t.details.forEach(function(o){var r=o.fechas.split("al"),a=o.horario.split(" a "),d=r[0].trim().toLowerCase(),l=e(d+" "+a[1]);d+=" "+a[0];var u=r[1].trim().toLowerCase()+" "+a[1];d=e(d),u=e(u);for(var c=o.salon,E="",T=0;T<o.dias.length;T++)""!==o.dias[T].trim()&&(""!==E&&(E+=","),E+=s[T]);i+=m.format(n,d,l,c,u,E,t.name)})}),i+="END:VCALENDAR",setTimeout(function(){o()},500)},menso.src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js";}());
